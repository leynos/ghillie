openapi: 3.1.0
info:
  title: Ghillie Runtime API
  version: 0.1.0
  description: >-
    Minimal HTTP surface for Kubernetes probes. The runtime only exposes
    liveness and readiness endpoints.
servers:
  - url: http://{host}:{port}
    description: Runtime server
    variables:
      host:
        default: localhost
        description: Hostname or IP for the runtime server.
      port:
        default: "8080"
        description: TCP port for the runtime server.
security:
  - ApiKeyAuth: []
paths:
  /health:
    get:
      summary: Liveness probe
      description: Returns ok when the process is alive.
      tags:
        - Health
      security: []
      responses:
        "200":
          description: Service is alive.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HealthStatus"
              examples:
                ok:
                  value:
                    status: ok
  /ready:
    get:
      summary: Readiness probe
      description: Returns ready when the service is ready to accept traffic.
      tags:
        - Health
      security: []
      responses:
        "200":
          description: Service is ready.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ReadyStatus"
              examples:
                ready:
                  value:
                    status: ready
components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: Authorization
      description: >-
        Placeholder authentication scheme for future endpoints. Health and
        readiness endpoints explicitly opt out of authentication.
  schemas:
    BaseStatus:
      type: object
      additionalProperties: false
      required:
        - status
      properties:
        status:
          type: string
    HealthStatus:
      allOf:
        - $ref: "#/components/schemas/BaseStatus"
        - type: object
          properties:
            status:
              const: ok
    ReadyStatus:
      allOf:
        - $ref: "#/components/schemas/BaseStatus"
        - type: object
          properties:
            status:
              const: ready
